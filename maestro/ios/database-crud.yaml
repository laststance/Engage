appId: com.anonymous.engage
tags: [ios, database, crud]
---
# Database CRUD Operations E2E Test
# Tests Create, Read, Update, Delete operations through UI

- launchApp:
    clearState: true
- waitForAnimationToEnd:
    timeout: 3000

# Setup: Navigate to Today view
- tapOn:
    point: 50%, 93% # Today tab
    repeat: 2
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

# Test navigation to Stats tab
- tapOn:
    point: 83%, 93% # Stats tab
    repeat: 2
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

# Wait for stats screen to load
- extendedWaitUntil:
    visible:
      id: 'statistics-screen'
    timeout: 10000

# Test navigation back to Today tab
- tapOn:
    point: 50%, 93% # Back to Today tab
    repeat: 2
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

# Test navigation to Calendar tab
- tapOn:
    point: 17%, 93% # Calendar tab
    repeat: 2
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

# Wait for calendar screen to load
- extendedWaitUntil:
    visible:
      id: 'calendar-screen'
    timeout: 10000

# Test date selection (CREATE operation simulation)
- tapOn:
    point: 50%, 45% # Middle of calendar
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

# Test journal entry if modal opened (CREATE operation)
- runFlow:
    when:
      visible:
        id: 'journal-input'
    commands:
      - tapOn:
          id: 'journal-input'
      - inputText: '初回エントリー作成テスト'
      - waitForAnimationToEnd:
          timeout: 1000
      - tapOn:
          id: 'day-modal-close'
      - waitForAnimationToEnd:
          timeout: 2000

# Navigate back to Today tab for final verification
- tapOn:
    point: 50%, 93% # Today tab
    repeat: 2
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

# Final verification - return to Calendar
- tapOn:
    point: 17%, 93% # Calendar tab
    repeat: 2
    waitToSettleTimeoutMs: 1000
- waitForAnimationToEnd:
    timeout: 2000

- assertVisible:
    id: 'calendar-screen'
